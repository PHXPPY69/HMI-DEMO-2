:root {
  /* Original design dimensions */
  --design-w: 932;
  --design-h: 430;
  /* Initial scale */
  --scale: 1;
}

.cell-page {
  /* Scale from top-left corner */
  transform-origin: top left;
  /* Lock in design dimensions */
  width: var(--design-w)px;
  height: var(--design-h)px;
  /* Apply dynamic scale */
  transform: scale(var(--scale));
  overflow: hidden;
}

/* ──────────────────────────────────────────────────────────
   Desktop Default ≥1500px
   ────────────────────────────────────────────────────────── */
.cells {
  grid-template-columns: repeat(3, var(--cell-w));
  justify-content: center;
}

/* ──────────────────────────────────────────────────────────
   Medium screen ≤1500px
   ────────────────────────────────────────────────────────── */
@media (max-width:1500px) {
  .cells {
    grid-template-columns: repeat(3, var(--cell-w));
    justify-content: center;
  }
}



/* ========== Responsive 6 cells (3 columns × 2 rows) เฉพาะ 901px–1100px ========== */
@media (min-width:901px) and (max-width:1100px) {
  .grid {
    grid-template-columns: 1fr;    
    grid-template-rows: auto auto auto;
  }

  .cells {
    grid-column: 1 / -1;
    grid-row: auto;
    display: grid;

    /* ✅ บังคับ 3 คอลัมน์ x 2 แถว */
    grid-template-columns: repeat(6, var(--cell-w));
    grid-auto-rows: auto;

    /* ✅ เพิ่มระยะห่างเฉพาะช่วงนี้ */
    gap: 11px 20px;   

    align-items: start;
    justify-content: center;

    max-width: calc(var(--cell-w) * 3 + 60px * 2);
    margin: 0 auto;
    padding: 20px 0;

    /* ✅ ขยับขวาเฉพาะ 901px–1100px เท่านั้น */
    transform: translateX(216px);
  }

  .cells .card.cell {
    width: var(--cell-w);
    margin: 0;
    align-self: start;
  }
}

/* ========== iPad Air — Portrait (≈ 820 × 1180) : ยืดสูงทั้งใบ ========== */
@media (min-width:800px) and (max-width:900px) and (orientation:portrait){

  /* …บล็อก .grid ของคุณคงเดิม… */

  .cells{
    /* ── ขนาดหลักของการ์ดและชิ้นส่วน ── */
    --cell-h: calc(420px * var(--cell-scale));   /* ↑ สูงฐานของการ์ด */
    --cell-y: 1.10;                               /* ↑ ยืดแนวตั้งรวม (tank/steps ก็ยืด) */

    --tank-h: calc(340px * var(--cell-scale));    /* ↑ สูงของถัง */
    --tank-w: calc(60px  * var(--cell-scale));
    --tube-w: calc(24px  * var(--cell-scale));
    --rung-w: calc(54px  * var(--cell-scale));    /* กว้างแท่ง steps นิดหน่อย */
    --pad-v:  calc(12px  * var(--cell-scale));

    /* layout 3×2 ของคุณคงเดิม */
    grid-column: 1 / -1;
    grid-row: auto;
    display: grid;
    grid-template-columns: repeat(6, minmax(var(--cell-w), 1fr));
    grid-auto-rows: auto;
    gap: 5px 1px;
    justify-content: center;
    align-items: start;
    max-width: calc(var(--cell-w) * 3 + 16px * 2);
    margin: 0 auto;
    padding: 13px 0; /* เผื่อพื้นที่ด้านล่าง กันโดนตัด */
    transform: translateX(244px);
  }

  /* การ์ด cell ต้องอ้างกับตัวแปรความสูงรวม */
  .cells .card.cell{
    width: 90%;
    max-width: var(--cell-w);
    height: calc(var(--cell-h) * var(--cell-y)); /* ✅ สูงขึ้นทั้งใบ */
    margin: 0;
    align-self: start;
  }

  /* Tank ยืดตามตัวแปรใหม่ */
  .cells .tank{
    height: calc(var(--tank-h) * var(--cell-y));
    width:  var(--tank-w);
    padding: var(--pad-v);
  }
  .cells .tank .tube{
    width: var(--tube-w);
    left: calc((var(--tank-w) - var(--tube-w)) / 2);
    top: var(--pad-v);
    bottom: var(--pad-v);
    border-width: 6px;
  }
  .cells .tank .fill{
    width: var(--tube-w);
    height: calc(var(--fill-pct, 40) * 1%);
    left: calc((var(--tank-w) - var(--tube-w)) / 2);
    bottom: var(--pad-v);
  }

  /* Steps ยืดให้เท่ากับ tank และกว้างขึ้นเล็กน้อย */
  .cells .steps{
    height: calc(var(--tank-h) * var(--cell-y));  /* ✅ สูงเท่าถัง */
    width:  var(--rung-w);
    padding: var(--pad-v) calc(10px * var(--cell-scale));
  }
  .cells .steps span{
    height: calc(var(--step-h) * 1.1);            /* ขยายขั้นให้สมส่วน */
  }
}


/* ========== iPad Air — Landscape (ประมาณ 1180 × 820) ========== */
@media (min-width:1101px) and (max-width:1280px) and (orientation:landscape){
  .grid{
    grid-template-columns: 1fr;         /* ซ้อนเป็นคอลัมน์เดียวเพื่อให้กว้างพอ */
    grid-template-rows: auto auto auto; 
    gap: 16px;
  }

  .cells{
    grid-column: 1 / -1;
    grid-row: auto;
    display: grid;

    /* 3 คอลัมน์ × 2 แถว */
    grid-template-columns: repeat(6, var(--cell-w));
    grid-auto-rows: auto;

    gap: 11px 43px;
    justify-content: center;
    align-items: start;

    max-width: calc(var(--cell-w) * 3 + 36px * 2);
    margin: 0 auto;
    padding: 20px 0;

    transform: translateX(290px);         /* ไม่ใช้ค่าเลื่อนจากช่วง 901–1100px */
  }

  .cells .card.cell{
    width: 119%;                          /* ยืดเต็มช่อง */
    max-width: 350px;                     /* กันไม่ให้กว้างเกิน */
    margin: 0;
    align-self: start;
  }
}


/* ──────────────────────────────────────────────────────────
   Mobile (โทรศัพท์) ≤ 700px
   ────────────────────────────────────────────────────────── */
@media (max-width:700px) {
  :root { --cell-scale: 0.65; }
  .btn { min-height: 90px; }
}

/* ──────────────────────────────────────────────────────────
   Mobile (โทรศัพท์) ≤ 480px
   ────────────────────────────────────────────────────────── */
@media (max-width: 480px) {
  :root {
    --cell-scale: 0.58;
    --cell-gap:   calc(18px * var(--cell-scale));
  }
  
  .env-card {
    max-width: 370px;
    padding: 6px 8px;
  }
  .env-card .env .row {
    gap: 6px;
    padding: 4px 6px;
  }
  .env-card .env-icon {
    width: 28px;
    height: 28px;
  }
  .env-card .env .val {
    font-size: 1rem;
  }

  .grid {
    display: flex;
    flex-direction: column;
    padding: 12px;
  }

  .cells {
    display: grid;
    grid-template-columns: repeat(3, var(--cell-w));
    gap: var(--cell-gap);
    max-width: calc((var(--cell-w) * 3) + (var(--cell-gap) * 2));
    margin: 0 auto;
    padding: 4px 0;
  }

  .cells .card.cell {
    --c-bg: var(--cell-odd-bg);
    width: calc(200px * var(--cell-scale));
    height: calc(700px * var(--cell-scale));
  }
  
  .tank {
    position: relative;
  }
  .tank .tube {
    position: absolute;
    top: var(--pad-v);
    bottom: var(--pad-v);
    width: 14px;
    background: var(--tube-bg);
    border: 6px solid var(--tube-br);
    left: 50%;
    transform: translateX(-50%);
  }
  .tank .fill {
    position: absolute;
    width: 8px;
    height: calc(var(--fill-pct,40) * 1%);
    background: var(--fill);
    left: 50%;
    transform: translateX(-50%);
    transition: height .3s ease;
  }

  .motor-tag {
    font-size: 13px;
    padding: 1px 4px;
  }

  .btn {
    height: 200px;
    min-height: unset;
  }

  body {
    font-size: 0.9rem;
  }
  .order .title { font-size: 1.2rem; }
  .order .kv    { font-size: 0.8rem; }
  .env-card .env .val { font-size: calc(var(--env-font,42px) * 0.6); }
  .donut-only .donut-svg { width:150px; height:150px; }
  .donut-only .donut-svg #donutText { font-size:10px; }
  .btn { font-size:1rem; min-height:80px; }
  .chart-head,
  .legend,
  .xaxis { font-size:0.7rem; }
  .chart-frame { height:150px; }
  .card.cell h4      { font-size:1rem;  }
  .card.cell .pct    { font-size:0.85rem;}
}

/* ===== iPhone 14 Pro Max landscape ~ 932 x 430 ===== */
@media (max-width: 932px) and (max-height: 430px) and (orientation: landscape) {
  :root{
    --cell-scale: 0.63;
    --cell-gap:   calc(30px * var(--cell-scale));
    --cell-y:     1.25;
  }

  .grid{
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
  }

  .cells{
    grid-column: 1 / -1;
    grid-row: auto;
    display: grid;

    /* 3 คอลัมน์ x 2 แถว */
    grid-template-columns: repeat(6, var(--cell-w));
    gap: var(--cell-gap);

    max-width: calc(var(--cell-w)*3 + var(--cell-gap)*2);
    margin: 0 auto !important;
    justify-content: center;

    /* ขยับซ้าย 60px */
    transform: translateX(225px);
  }

  .card.cell{ padding: calc(10px * var(--cell-scale)); }
  .card.cell h4{  font-size: calc(1.4rem * var(--cell-scale)); }
  .card.cell .pct{font-size: calc(1.0rem * var(--cell-scale)); }
}
